# å±å¹•ç›‘æ§æˆªå›¾ä¸Šä¼ æ¥å£æ–‡æ¡£

## ğŸ“‹ æ¥å£æ¦‚è¿°

å±å¹•ç›‘æ§ç³»ç»Ÿæä¾›å¤šä¸ªæˆªå›¾ä¸Šä¼ æ¥å£ï¼Œç”¨äºå®¢æˆ·ç«¯ä¸Šä¼ å±å¹•æˆªå›¾ã€è¿è§„æˆªå›¾å’Œå¿ƒè·³æ•°æ®ã€‚æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»å„ä¸ªæ¥å£çš„ä½¿ç”¨æ–¹æ³•ã€å‚æ•°æ ¼å¼å’Œå“åº”ç»“æ„ã€‚

## ğŸ”— æ¥å£åˆ—è¡¨

### 1. é€šç”¨æ–‡ä»¶ä¸Šä¼ æ¥å£
- **æ¥å£åœ°å€**: `POST /api/files/upload`
- **ç”¨é€”**: é€šç”¨æ–‡ä»¶ä¸Šä¼ ï¼Œæ”¯æŒå„ç§æ–‡ä»¶ç±»å‹
- **è®¤è¯**: æ— éœ€è®¤è¯

### 2. è¿è§„ä¸ŠæŠ¥æ¥å£ï¼ˆå«æˆªå›¾ï¼‰
- **æ¥å£åœ°å€**: `POST /api/security/violations/report-with-screenshot`
- **ç”¨é€”**: å®¢æˆ·ç«¯ä¸ŠæŠ¥è¿è§„äº‹ä»¶å¹¶åŒæ—¶ä¸Šä¼ è¿è§„æˆªå›¾
- **è®¤è¯**: æ— éœ€è®¤è¯

### 3. å®‰å…¨å‘Šè­¦æŸ¥è¯¢æ¥å£
- **æ¥å£åœ°å€**: `GET /api/security/alerts`
- **ç”¨é€”**: æŸ¥è¯¢å®‰å…¨å‘Šè­¦åˆ—è¡¨ï¼Œæ”¯æŒåˆ†é¡µå’Œç­›é€‰
- **è®¤è¯**: æ— éœ€è®¤è¯

### 4. å®‰å…¨å‘Šè­¦çŠ¶æ€æ›´æ–°æ¥å£
- **æ¥å£åœ°å€**: `PUT /api/security/alerts/:id/status`
- **ç”¨é€”**: æ›´æ–°å‘Šè­¦çŠ¶æ€ï¼ˆç¡®è®¤ã€å¿½ç•¥ã€è¯¯æŠ¥ç­‰ï¼‰
- **è®¤è¯**: æ— éœ€è®¤è¯

### 5. æ‰¹é‡å¿½ç•¥å‘Šè­¦æ¥å£
- **æ¥å£åœ°å€**: `POST /api/security/alerts/ignore-all`
- **ç”¨é€”**: å¿½ç•¥æŒ‡å®šå®¢æˆ·ç«¯çš„æ‰€æœ‰æœªå¤„ç†è¿è§„
- **è®¤è¯**: æ— éœ€è®¤è¯

### 6. å®¢æˆ·ç«¯å¿ƒè·³æ¥å£
- **æ¥å£åœ°å€**: `POST /api/clients/heartbeat`
- **ç”¨é€”**: å®¢æˆ·ç«¯å‘é€å¿ƒè·³ä¿¡æ¯ï¼Œæ›´æ–°åœ¨çº¿çŠ¶æ€
- **è®¤è¯**: æ— éœ€è®¤è¯

### 7. å®¢æˆ·ç«¯æ³¨å†Œæ¥å£
- **æ¥å£åœ°å€**: `POST /api/clients/register`
- **ç”¨é€”**: æ–°å®¢æˆ·ç«¯æ³¨å†Œï¼Œè·å–å”¯ä¸€å®¢æˆ·ç«¯ID
- **è®¤è¯**: æ— éœ€è®¤è¯

## ğŸ“ æ¥å£è¯¦ç»†è¯´æ˜

### 1. é€šç”¨æ–‡ä»¶ä¸Šä¼ æ¥å£

#### åŸºæœ¬ä¿¡æ¯
```
POST /api/files/upload
Content-Type: multipart/form-data
```

#### è¯·æ±‚å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|------|
| `file` | File | âœ… | è¦ä¸Šä¼ çš„æ–‡ä»¶ | screenshot.jpg |

#### è¯·æ±‚ç¤ºä¾‹
```bash
curl -X POST http://localhost:3001/api/files/upload \
  -F "file=@screenshot.jpg"
```

#### å“åº”æ ¼å¼
```json
{
  "success": true,
  "data": {
    "key": "files/2025/08/22/uuid-filename.jpg",
    "url": "http://localhost:9000/monitoring-screenshots/files/2025/08/22/uuid-filename.jpg",
    "size": 245760,
    "contentType": "image/jpeg"
  }
}
```

### 2. å®‰å…¨å‘Šè­¦æŸ¥è¯¢æ¥å£

#### åŸºæœ¬ä¿¡æ¯
```
GET /api/security/alerts
Content-Type: application/json
```

#### è¯·æ±‚å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|------|
| `clientId` | String | âŒ | å®¢æˆ·ç«¯IDç­›é€‰ | `a1b2c3d4-e5f6-7890-abcd-ef1234567890` |
| `page` | Number | âŒ | é¡µç  | `1` |
| `pageSize` | Number | âŒ | æ¯é¡µæ•°é‡ | `20` |
| `status` | String | âŒ | å‘Šè­¦çŠ¶æ€ç­›é€‰ | `pending` |
| `alertType` | String | âŒ | å‘Šè­¦ç±»å‹ç­›é€‰ | `BLOCKCHAIN_ADDRESS` |
| `startDate` | String | âŒ | å¼€å§‹æ—¥æœŸ | `2025-08-01` |
| `endDate` | String | âŒ | ç»“æŸæ—¥æœŸ | `2025-08-31` |

#### è¯·æ±‚ç¤ºä¾‹
```bash
curl -X GET "http://localhost:3001/api/security/alerts?clientId=ff27b3c0-ae17-4550-9864-f4ab26926943&page=1&pageSize=10"
```

#### å“åº”æ ¼å¼
```json
{
  "success": true,
  "data": {
    "alerts": [
      {
        "id": 16244,
        "alertId": "e40aaa87-2d4b-4912-ab13-30eba79146d2",
        "clientId": "ff27b3c0-ae17-4550-9864-f4ab26926943",
        "clientName": "å®¢æˆ·ç«¯-VM-0-12-ubuntu",
        "alertType": "BLOCKCHAIN_ADDRESS",
        "detectedAddress": "1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa",
        "addressType": "BITCOIN",
        "clipboardContent": "",
        "screenshotUrl": "/storage/screenshots/client-id/violation.jpg",
        "status": "pending",
        "riskLevel": "HIGH",
        "createdAt": "2025-08-21T19:46:46.000Z",
        "remark": null
      }
    ],
    "total": 8,
    "page": 1,
    "pageSize": 10,
    "totalPages": 1
  }
}
```

### 3. å®‰å…¨å‘Šè­¦çŠ¶æ€æ›´æ–°æ¥å£

#### åŸºæœ¬ä¿¡æ¯
```
PUT /api/security/alerts/:id/status
Content-Type: application/json
```

#### è¯·æ±‚å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|------|
| `status` | String | âœ… | æ–°çŠ¶æ€ | `confirmed` |
| `remark` | String | âŒ | å¤„ç†å¤‡æ³¨ | `å·²ç¡®è®¤ä¸ºçœŸå®è¿è§„` |

#### çŠ¶æ€å€¼è¯´æ˜
- `pending` - å¾…å¤„ç†
- `confirmed` - å·²ç¡®è®¤
- `false_positive` - è¯¯æŠ¥
- `ignored` - å·²å¿½ç•¥
- `resolved` - å·²è§£å†³

#### è¯·æ±‚ç¤ºä¾‹
```bash
curl -X PUT http://localhost:3001/api/security/alerts/16244/status \
  -H "Content-Type: application/json" \
  -d '{"status": "confirmed", "remark": "å·²ç¡®è®¤ä¸ºçœŸå®è¿è§„"}'
```

#### å“åº”æ ¼å¼
```json
{
  "success": true,
  "message": "å‘Šè­¦çŠ¶æ€æ›´æ–°æˆåŠŸ"
}
```

### 4. æ‰¹é‡å¿½ç•¥å‘Šè­¦æ¥å£

#### åŸºæœ¬ä¿¡æ¯
```
POST /api/security/alerts/ignore-all
Content-Type: application/json
```

#### è¯·æ±‚å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|------|
| `clientId` | String | âœ… | å®¢æˆ·ç«¯ID | `a1b2c3d4-e5f6-7890-abcd-ef1234567890` |

#### è¯·æ±‚ç¤ºä¾‹
```bash
curl -X POST http://localhost:3001/api/security/alerts/ignore-all \
  -H "Content-Type: application/json" \
  -d '{"clientId": "ff27b3c0-ae17-4550-9864-f4ab26926943"}'
```

#### å“åº”æ ¼å¼
```json
{
  "success": true,
  "message": "å·²å¿½ç•¥ 5 æ¡æœªå¤„ç†è¿è§„",
  "affected": 5
}
```

### 5. è¿è§„ä¸ŠæŠ¥æ¥å£ï¼ˆå«æˆªå›¾ï¼‰

#### åŸºæœ¬ä¿¡æ¯
```
POST /api/security/violations/report-with-screenshot
Content-Type: multipart/form-data
```

#### è¯·æ±‚å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|------|
| `file` | File | âœ… | è¿è§„æˆªå›¾æ–‡ä»¶ | violation_screenshot.jpg |
| `clientId` | String | âœ… | å®¢æˆ·ç«¯å”¯ä¸€æ ‡è¯†ç¬¦ | `a1b2c3d4-e5f6-7890-abcd-ef1234567890` |
| `violationType` | String | âœ… | è¿è§„ç±»å‹ | `BLOCKCHAIN_ADDRESS` |
| `violationContent` | String | âœ… | è¿è§„å†…å®¹ | `1BvBMSEYstWetqTFn5Au4m4GFg7xJaNVN2` |
| `timestamp` | String | âœ… | è¿è§„å‘ç”Ÿæ—¶é—´ | `2025-08-22T10:30:00.000Z` |
| `additionalData` | String | âŒ | é™„åŠ æ•°æ®ï¼ˆJSONå­—ç¬¦ä¸²ï¼‰ | `{"clipboardContent":"..."}` |

#### è¯·æ±‚ç¤ºä¾‹
```bash
curl -X POST http://localhost:3001/api/security/violations/report-with-screenshot \
  -F "file=@violation_screenshot.jpg" \
  -F "clientId=a1b2c3d4-e5f6-7890-abcd-ef1234567890" \
  -F "violationType=BLOCKCHAIN_ADDRESS" \
  -F "violationContent=1BvBMSEYstWetqTFn5Au4m4GFg7xJaNVN2" \
  -F "timestamp=2025-08-22T10:30:00.000Z" \
  -F "additionalData={\"clipboardContent\":\"å‘ç°æ¯”ç‰¹å¸åœ°å€\"}"
```

#### å“åº”æ ¼å¼
```json
{
  "success": true,
  "message": "è¿è§„äº‹ä»¶ä¸ŠæŠ¥æˆåŠŸ",
  "alertId": 16239,
  "screenshotUrl": "http://localhost:9000/monitoring-screenshots/violations/client-id/2025-08-22T10-30-00-000Z_uuid.jpg"
}
```

### 3. å®¢æˆ·ç«¯å¿ƒè·³æ¥å£

#### åŸºæœ¬ä¿¡æ¯
```
POST /api/clients/heartbeat
Content-Type: application/json
```

#### è¯·æ±‚å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|------|
| `clientId` | String | âœ… | å®¢æˆ·ç«¯ID | `client-001` |
| `ipAddress` | String | âŒ | å®¢æˆ·ç«¯IPåœ°å€ | `192.168.1.100` |
| `hostname` | String | âŒ | å®¢æˆ·ç«¯ä¸»æœºå | `DESKTOP-ABC123` |
| `osInfo` | String | âŒ | æ“ä½œç³»ç»Ÿä¿¡æ¯ | `Windows 10` |
| `version` | String | âŒ | å®¢æˆ·ç«¯ç‰ˆæœ¬ | `1.0.0` |
| `metadata` | Object | âŒ | é¢å¤–çš„å®¢æˆ·ç«¯ä¿¡æ¯ | `{"platform": "Python"}` |

#### è¯·æ±‚ç¤ºä¾‹
```bash
curl -X POST http://localhost:3001/api/clients/heartbeat \
  -H "Content-Type: application/json" \
  -d '{
    "clientId": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
    "ipAddress": "192.168.1.100",
    "hostname": "DESKTOP-ABC123",
    "osInfo": "Windows 10",
    "version": "1.0.0",
    "metadata": {
      "platform": "Python",
      "capabilities": {
        "screenshot": true,
        "clipboard_monitor": true
      }
    }
  }'
```

#### å“åº”æ ¼å¼
```json
{
  "success": true,
  "clientStatus": "online",
  "lastSeen": "2025-08-22T10:30:00.000Z",
  "message": "å¿ƒè·³å¤„ç†æˆåŠŸ"
}
```

### 4. å®¢æˆ·ç«¯æ³¨å†Œæ¥å£

#### åŸºæœ¬ä¿¡æ¯
```
POST /api/clients/register
Content-Type: application/json
```

#### è¯·æ±‚å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|------|
| `hostname` | String | âŒ | ä¸»æœºå | `DESKTOP-ABC123` |
| `ipAddress` | String | âŒ | IPåœ°å€ | `192.168.1.100` |
| `osInfo` | String | âŒ | æ“ä½œç³»ç»Ÿä¿¡æ¯ | `Windows 10` |
| `version` | String | âŒ | å®¢æˆ·ç«¯ç‰ˆæœ¬ | `1.0.0` |

#### è¯·æ±‚ç¤ºä¾‹
```bash
curl -X POST http://localhost:3001/api/clients/register \
  -H "Content-Type: application/json" \
  -d '{
    "hostname": "DESKTOP-ABC123",
    "ipAddress": "192.168.1.100",
    "osInfo": "Windows 10",
    "version": "1.0.0"
  }'
```

#### å“åº”æ ¼å¼
```json
{
  "success": true,
  "data": {
    "clientId": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
    "message": "å®¢æˆ·ç«¯æ³¨å†ŒæˆåŠŸ"
  }
}
```

## ğŸ”§ Pythonå®¢æˆ·ç«¯ä½¿ç”¨ç¤ºä¾‹

### 1. å®¢æˆ·ç«¯æ³¨å†Œ
```python
import requests
import json

def register_client():
    url = "http://localhost:3001/api/clients/register"
    data = {
        "hostname": "PYTHON-CLIENT",
        "ipAddress": "192.168.1.100",
        "osInfo": "Windows 10",
        "version": "1.0.0"
    }
    
    response = requests.post(url, json=data)
    if response.status_code == 201:
        result = response.json()
        client_id = result['data']['clientId']
        print(f"æ³¨å†ŒæˆåŠŸï¼Œå®¢æˆ·ç«¯ID: {client_id}")
        return client_id
    else:
        print(f"æ³¨å†Œå¤±è´¥: {response.text}")
        return None
```

### 2. å‘é€å¿ƒè·³
```python
def send_heartbeat(client_id):
    url = "http://localhost:3001/api/clients/heartbeat"
    data = {
        "clientId": client_id,
        "ipAddress": "192.168.1.100",
        "hostname": "PYTHON-CLIENT",
        "osInfo": "Windows 10",
        "version": "1.0.0",
        "metadata": {
            "platform": "Python",
            "capabilities": {
                "screenshot": True,
                "clipboard_monitor": True,
                "blockchain_detection": True
            }
        }
    }
    
    response = requests.post(url, json=data)
    if response.status_code == 200:
        print("å¿ƒè·³å‘é€æˆåŠŸ")
        return True
    else:
        print(f"å¿ƒè·³å‘é€å¤±è´¥: {response.text}")
        return False
```

### 3. ä¸Šä¼ æ–‡ä»¶
```python
def upload_file(file_path):
    url = "http://localhost:3001/api/files/upload"
    
    with open(file_path, 'rb') as f:
        files = {'file': (file_path, f, 'image/jpeg')}
        response = requests.post(url, files=files)
    
    if response.status_code == 201:
        result = response.json()
        print(f"æ–‡ä»¶ä¸Šä¼ æˆåŠŸ: {result['data']['url']}")
        return result['data']
    else:
        print(f"æ–‡ä»¶ä¸Šä¼ å¤±è´¥: {response.text}")
        return None
```

### 4. ä¸ŠæŠ¥è¿è§„äº‹ä»¶
```python
def report_violation(client_id, screenshot_path, violation_content):
    url = "http://localhost:3001/api/security/violations/report-with-screenshot"
    
    # å‡†å¤‡è¡¨å•æ•°æ®
    data = {
        'clientId': client_id,
        'violationType': 'BLOCKCHAIN_ADDRESS',
        'violationContent': violation_content,
        'timestamp': datetime.now().isoformat() + 'Z',
        'additionalData': json.dumps({
            'clipboardContent': f'å‘ç°åŒºå—é“¾åœ°å€: {violation_content}',
            'detectionMethod': 'clipboard_monitor',
            'riskLevel': 'HIGH'
        })
    }
    
    # å‡†å¤‡æ–‡ä»¶æ•°æ®
    with open(screenshot_path, 'rb') as f:
        files = {'file': (f'violation_{int(time.time())}.jpg', f, 'image/jpeg')}
        response = requests.post(url, files=files, data=data)
    
    if response.status_code == 201:
        result = response.json()
        print(f"è¿è§„ä¸ŠæŠ¥æˆåŠŸï¼Œå‘Šè­¦ID: {result['alertId']}")
        return result
    else:
        print(f"è¿è§„ä¸ŠæŠ¥å¤±è´¥: {response.text}")
        return None
```

## ğŸ“Š é”™è¯¯å¤„ç†

### å¸¸è§é”™è¯¯ç 
| çŠ¶æ€ç  | è¯´æ˜ | è§£å†³æ–¹æ³• |
|--------|------|----------|
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ | æ£€æŸ¥è¯·æ±‚å‚æ•°æ ¼å¼å’Œå¿…å¡«å­—æ®µ |
| 404 | å®¢æˆ·ç«¯ä¸å­˜åœ¨ | å…ˆè°ƒç”¨æ³¨å†Œæ¥å£è·å–å®¢æˆ·ç«¯ID |
| 413 | æ–‡ä»¶è¿‡å¤§ | å‹ç¼©æ–‡ä»¶æˆ–æ£€æŸ¥æ–‡ä»¶å¤§å°é™åˆ¶ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ | æ£€æŸ¥æœåŠ¡å™¨æ—¥å¿—ï¼Œè”ç³»æŠ€æœ¯æ”¯æŒ |

### é”™è¯¯å“åº”æ ¼å¼
```json
{
  "success": false,
  "message": "é”™è¯¯æè¿°",
  "error": "è¯¦ç»†é”™è¯¯ä¿¡æ¯",
  "statusCode": 400
}
```

## ğŸ”’ å®‰å…¨è¯´æ˜

### 1. è®¤è¯æœºåˆ¶
- å½“å‰æ‰€æœ‰æ¥å£éƒ½æ— éœ€è®¤è¯
- å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä¸­æ·»åŠ é€‚å½“çš„è®¤è¯æœºåˆ¶
- å¯ä»¥é€šè¿‡IPç™½åå•é™åˆ¶è®¿é—®

### 2. æ•°æ®éªŒè¯
- æ‰€æœ‰æ¥å£éƒ½æœ‰ä¸¥æ ¼çš„å‚æ•°éªŒè¯
- æ–‡ä»¶ç±»å‹å’Œå¤§å°éƒ½æœ‰é™åˆ¶
- å®¢æˆ·ç«¯IDå¿…é¡»æ˜¯æœ‰æ•ˆçš„UUIDæ ¼å¼

### 3. å­˜å‚¨å®‰å…¨
- æ–‡ä»¶å­˜å‚¨åœ¨MinIOå¯¹è±¡å­˜å‚¨ä¸­
- æ”¯æŒè®¿é—®æ§åˆ¶å’Œæƒé™ç®¡ç†
- è¿è§„æˆªå›¾æ°¸ä¹…ä¿å­˜ï¼Œæ™®é€šæˆªå›¾å¯é…ç½®ä¿ç•™ç­–ç•¥

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### 1. æ–‡ä»¶å‹ç¼©
- å»ºè®®å®¢æˆ·ç«¯åœ¨ä¸Šä¼ å‰å‹ç¼©æˆªå›¾
- æ”¯æŒJPEGè´¨é‡è°ƒæ•´
- æ¨èåˆ†è¾¨ç‡ä¸è¶…è¿‡2560px

### 2. æ‰¹é‡æ“ä½œ
- æ”¯æŒå¼‚æ­¥ä¸Šä¼ é˜Ÿåˆ—
- å¯é…ç½®å¹¶å‘ä¸Šä¼ æ•°é‡
- è‡ªåŠ¨é‡è¯•æœºåˆ¶

### 3. ç¼“å­˜ç­–ç•¥
- ä½¿ç”¨Redisç¼“å­˜å®¢æˆ·ç«¯çŠ¶æ€
- MinIOæ”¯æŒCDNåŠ é€Ÿ
- æ”¯æŒé¢„ç­¾åURLç›´ä¼ 

## ğŸ§ª æ¥å£æµ‹è¯•

### ä½¿ç”¨Postmanæµ‹è¯•

#### 1. æµ‹è¯•æ–‡ä»¶ä¸Šä¼ 
```
POST http://localhost:3001/api/files/upload
Body: form-data
- file: [é€‰æ‹©æ–‡ä»¶] screenshot.jpg
```

#### 2. æµ‹è¯•è¿è§„ä¸ŠæŠ¥
```
POST http://localhost:3001/api/security/violations/report-with-screenshot
Body: form-data
- file: [é€‰æ‹©æ–‡ä»¶] violation.jpg
- clientId: a1b2c3d4-e5f6-7890-abcd-ef1234567890
- violationType: BLOCKCHAIN_ADDRESS
- violationContent: 1BvBMSEYstWetqTFn5Au4m4GFg7xJaNVN2
- timestamp: 2025-08-22T10:30:00.000Z
- additionalData: {"clipboardContent":"æµ‹è¯•è¿è§„"}
```

#### 3. æµ‹è¯•å¿ƒè·³
```
POST http://localhost:3001/api/clients/heartbeat
Body: raw (JSON)
{
  "clientId": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
  "ipAddress": "192.168.1.100",
  "hostname": "TEST-CLIENT",
  "osInfo": "Windows 10",
  "version": "1.0.0"
}
```

### ä½¿ç”¨curlæµ‹è¯•

#### å®Œæ•´çš„å®¢æˆ·ç«¯æµç¨‹æµ‹è¯•
```bash
#!/bin/bash

# 1. æ³¨å†Œå®¢æˆ·ç«¯
echo "=== æ³¨å†Œå®¢æˆ·ç«¯ ==="
REGISTER_RESPONSE=$(curl -s -X POST http://localhost:3001/api/clients/register \
  -H "Content-Type: application/json" \
  -d '{
    "hostname": "TEST-CLIENT",
    "ipAddress": "192.168.1.100",
    "osInfo": "Linux Ubuntu 20.04",
    "version": "1.0.0"
  }')

echo "æ³¨å†Œå“åº”: $REGISTER_RESPONSE"

# æå–å®¢æˆ·ç«¯ID
CLIENT_ID=$(echo $REGISTER_RESPONSE | jq -r '.data.clientId')
echo "å®¢æˆ·ç«¯ID: $CLIENT_ID"

# 2. å‘é€å¿ƒè·³
echo -e "\n=== å‘é€å¿ƒè·³ ==="
HEARTBEAT_RESPONSE=$(curl -s -X POST http://localhost:3001/api/clients/heartbeat \
  -H "Content-Type: application/json" \
  -d "{
    \"clientId\": \"$CLIENT_ID\",
    \"ipAddress\": \"192.168.1.100\",
    \"hostname\": \"TEST-CLIENT\",
    \"osInfo\": \"Linux Ubuntu 20.04\",
    \"version\": \"1.0.0\",
    \"metadata\": {
      \"platform\": \"Linux\",
      \"test\": true
    }
  }")

echo "å¿ƒè·³å“åº”: $HEARTBEAT_RESPONSE"

# 3. ä¸Šä¼ æµ‹è¯•æ–‡ä»¶
echo -e "\n=== ä¸Šä¼ æµ‹è¯•æ–‡ä»¶ ==="
# åˆ›å»ºæµ‹è¯•å›¾ç‰‡æ–‡ä»¶
echo "åˆ›å»ºæµ‹è¯•å›¾ç‰‡..."
convert -size 800x600 xc:white -pointsize 30 -fill black \
  -annotate +50+300 "Test Screenshot $(date)" test_screenshot.jpg

UPLOAD_RESPONSE=$(curl -s -X POST http://localhost:3001/api/files/upload \
  -F "file=@test_screenshot.jpg")

echo "ä¸Šä¼ å“åº”: $UPLOAD_RESPONSE"

# 4. ä¸ŠæŠ¥è¿è§„äº‹ä»¶
echo -e "\n=== ä¸ŠæŠ¥è¿è§„äº‹ä»¶ ==="
VIOLATION_RESPONSE=$(curl -s -X POST http://localhost:3001/api/security/violations/report-with-screenshot \
  -F "file=@test_screenshot.jpg" \
  -F "clientId=$CLIENT_ID" \
  -F "violationType=BLOCKCHAIN_ADDRESS" \
  -F "violationContent=1BvBMSEYstWetqTFn5Au4m4GFg7xJaNVN2" \
  -F "timestamp=$(date -u +%Y-%m-%dT%H:%M:%S.000Z)" \
  -F "additionalData={\"clipboardContent\":\"æµ‹è¯•è¿è§„äº‹ä»¶\",\"testMode\":true}")

echo "è¿è§„ä¸ŠæŠ¥å“åº”: $VIOLATION_RESPONSE"

# æ¸…ç†æµ‹è¯•æ–‡ä»¶
rm -f test_screenshot.jpg

echo -e "\n=== æµ‹è¯•å®Œæˆ ==="
```

## ğŸ“‹ æ¥å£è§„èŒƒ

### 1. è¯·æ±‚å¤´è§„èŒƒ
```
Content-Type: multipart/form-data  # æ–‡ä»¶ä¸Šä¼ æ¥å£
Content-Type: application/json     # JSONæ•°æ®æ¥å£
User-Agent: ScreenMonitor-Client/1.0.0
```

### 2. æ–‡ä»¶å‘½åè§„èŒƒ
- **æ™®é€šæˆªå›¾**: `screenshot_YYYYMMDD_HHMMSS.jpg`
- **è¿è§„æˆªå›¾**: `violation_YYYYMMDD_HHMMSS.jpg`
- **æ–‡ä»¶å¤§å°**: å»ºè®®ä¸è¶…è¿‡2MB
- **å›¾ç‰‡æ ¼å¼**: æ”¯æŒJPGã€PNGï¼Œæ¨èJPG
- **å›¾ç‰‡è´¨é‡**: å»ºè®®JPEGè´¨é‡60-90

### 3. æ—¶é—´æ ¼å¼è§„èŒƒ
- **æ ‡å‡†æ ¼å¼**: ISO 8601æ ¼å¼
- **ç¤ºä¾‹**: `2025-08-22T10:30:00.000Z`
- **æ—¶åŒº**: ç»Ÿä¸€ä½¿ç”¨UTCæ—¶é—´

### 4. å®¢æˆ·ç«¯IDè§„èŒƒ
- **æ ¼å¼**: UUID v4æ ¼å¼
- **ç¤ºä¾‹**: `a1b2c3d4-e5f6-7890-abcd-ef1234567890`
- **ç”Ÿæˆ**: æœåŠ¡å™¨ç«¯ç”Ÿæˆï¼Œå®¢æˆ·ç«¯ä¿å­˜

## ğŸ”„ æ¥å£ç‰ˆæœ¬ç®¡ç†

### å½“å‰ç‰ˆæœ¬: v1.0
- æ”¯æŒåŸºæœ¬çš„æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
- æ”¯æŒè¿è§„äº‹ä»¶ä¸ŠæŠ¥
- æ”¯æŒå®¢æˆ·ç«¯å¿ƒè·³å’Œæ³¨å†Œ

### è®¡åˆ’ç‰ˆæœ¬: v1.1
- æ·»åŠ æˆªå›¾+å¿ƒè·³åˆå¹¶æ¥å£ `upload-with-heartbeat`
- æ”¯æŒæ‰¹é‡æ–‡ä»¶ä¸Šä¼ 
- å¢åŠ æ–‡ä»¶é¢„ç­¾åURLåŠŸèƒ½

### ç‰ˆæœ¬å…¼å®¹æ€§
- å‘åå…¼å®¹æ‰€æœ‰v1.xç‰ˆæœ¬
- æ–°å¢æ¥å£ä¸å½±å“ç°æœ‰åŠŸèƒ½
- åºŸå¼ƒæ¥å£ä¼šæå‰é€šçŸ¥

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### å¸¸è§é—®é¢˜
1. **Q: ä¸Šä¼ æ–‡ä»¶å¤±è´¥ï¼Œæç¤ºæ–‡ä»¶è¿‡å¤§**
   A: æ£€æŸ¥æ–‡ä»¶å¤§å°ï¼Œå»ºè®®å‹ç¼©åå†ä¸Šä¼ ï¼Œå•æ–‡ä»¶é™åˆ¶2MB

2. **Q: å®¢æˆ·ç«¯IDæ— æ•ˆ**
   A: ç¡®ä¿å…ˆè°ƒç”¨æ³¨å†Œæ¥å£è·å–æœ‰æ•ˆçš„å®¢æˆ·ç«¯ID

3. **Q: å¿ƒè·³å‘é€å¤±è´¥**
   A: æ£€æŸ¥ç½‘ç»œè¿æ¥å’ŒæœåŠ¡å™¨çŠ¶æ€ï¼Œç¡®è®¤å®¢æˆ·ç«¯IDæœ‰æ•ˆ

4. **Q: è¿è§„ä¸ŠæŠ¥æ²¡æœ‰åˆ›å»ºå‘Šè­¦**
   A: æ£€æŸ¥violationTypeå’ŒviolationContentæ ¼å¼æ˜¯å¦æ­£ç¡®

### è°ƒè¯•å»ºè®®
1. å¯ç”¨è¯¦ç»†æ—¥å¿—è®°å½•
2. æ£€æŸ¥ç½‘ç»œè¿æ¥çŠ¶æ€
3. éªŒè¯è¯·æ±‚å‚æ•°æ ¼å¼
4. æŸ¥çœ‹æœåŠ¡å™¨ç«¯æ—¥å¿—

### è”ç³»æ–¹å¼
- **æŠ€æœ¯æ”¯æŒ**: æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯
- **APIæ–‡æ¡£**: http://localhost:3001/api-docs
- **ç³»ç»ŸçŠ¶æ€**: http://localhost:3001/health

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æ›´æ–°æ—¥æœŸ**: 2025-08-22
**é€‚ç”¨ç‰ˆæœ¬**: åç«¯ v1.0.0+
**ç»´æŠ¤è€…**: å±å¹•ç›‘æ§ç³»ç»Ÿå¼€å‘å›¢é˜Ÿ
